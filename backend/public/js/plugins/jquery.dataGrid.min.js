(function(b,e,g,t){var n=function(a,c){this.$element=a;this.defaults={numberIndex:!1,numberIndexWidth:.03,condition:{},pageSize:[20,30,50,100],url:"",method:"get",height:500,condition:{start:0,length:20},field:[],hasLongText:!1,title:{name:"Data Grid",className:""}};this.options=b.extend({},this.defaults,c)};e=n.prototype;e.init=function(){var a=this.options,c;this._renderTitle(a,void 0);0<a.field.length&&this._renderHeader(a,void 0);c=g.createElement("div");c.className="dgbody";c.style.height=a.height+
"px";c.setAttribute("id","dgbody");this.$element.append(c);a=g.createElement("div");a.className="dgfooter";var f="";b.each(this.options.pageSize,function(a,b){f+='<option value="'+b+'">'+b+"</option>"});a.innerHTML='<span>\u6bcf\u9875<select id="page-size" class="page-size">'+f+'</select>\u8bb0\u5f55</span> &nbsp;<a href="javascript:void(0);" class="page-btn page-first page-disable"><span></span></a>&nbsp;<a href="javascript:void(0);" class="page-btn page-pre page-disable"><span></span></a>&nbsp;\u7b2c<select id="page" class="page-size"><option value="1">1</option></select>\u9875<a href="javascript:void(0);" class="page-btn page-next page-disable"><span></span></a>&nbsp;<a href="javascript:void(0);" class="page-btn page-last page-disable"><span></span></a>&nbsp;<span class="page-right">\u5c55\u793a <span id="page-total">0</span> \u6761\u6570\u636e\u4e2d\u7684 <span id="page-start">0</span> \u5230 <span id="page-end">0</span> \u6761</span>';
a.setAttribute("id","dgfooter");this.$element.append(a);this._bindEvent();this._loadBody()};e._bindEvent=function(){var a=this;b("#page-size").change(function(c){a._loadBody({length:b(this).val()})});b("#page").change(function(c){a._loadBody({start:(b(this).val()-1)*a.options.condition.length})});b(".page-first").click(function(c){b(this).hasClass("page-disable")||a._loadBody({start:0})});b(".page-pre").click(function(c){b(this).hasClass("page-disable")||a._loadBody({start:(b("#page").val()-2)*a.options.condition.length})});
b(".page-next").click(function(c){b(this).hasClass("page-disable")||a._loadBody({start:(b("#page").val()-2)*a.options.condition.length})});b(".page-last").click(function(c){b(this).hasClass("page-disable")||a._loadBody({start:(b("#page option:last").attr("value")-1)*a.options.condition.length})})};e.reload=function(a){this._loadBody(a)};e._loadBody=function(a){g.getElementById("dgbody").innerHTML="";b.extend(this.options.condition,a);var c=this;"POST"==this.options.method.toUpperCase()?b.post(this.options.url,
this.options.condition,function(a,b,g){c._renderBodyFooter(a)},"json"):b.get(this.options.url,this.options.condition,function(a){c._renderBodyFooter(a)},"json")};e._renderTitle=function(a,b){b=g.createElement("div");b.innerHTML=a.title.name;b.className="dgtitle "+(a.title.className?a.title.className:"");this.$element.append(b)};e._renderHeader=function(a,c){c=g.createElement("div");c.className="dghead ";var f=this.$element.width(),h=0,e=0;if(this.options.numberIndex){var d=g.createElement("div");
d.className="dghead-column-box";d.setAttribute("id","index_header");d.style.width=f*this.options.numberIndexWidth+"px";d.style.left=h+e++ +"px";var h=h+f*this.options.numberIndexWidth,k=g.createElement("div");k.className="dghead-column-item column-align-center";k.innerHTML="#";d.appendChild(k);c.appendChild(d)}b.each(a.field,function(a,b){if(!b.longText){var m=g.createElement("div");m.className="dghead-column-box "+(b.headClass?b.headClass:"");m.setAttribute("id",b.name+"_header");m.style.width=f*
b.width+"px";m.style.left=h+e++ +"px";h+=f*b.width;var d=g.createElement("div");d.className="dghead-column-item column-align-"+(b.headAlign?b.headAlign:"left");d.innerHTML=b.fieldName;m.appendChild(d);c.appendChild(m)}});this.$element.append(c)};e._renderBodyFooter=function(a){if(a.total&&0!=a.total){var c=a.total;a=a.data;var f=this,h=this.$element.width();b.each(a,function(a,c){var e=g.createElement("div");e.className="dgRow";if(f.options.numberIndex){var d=g.createElement("div");d.className="dg-left";
d.style.width=h*f.options.numberIndexWidth+"px";var k=g.createElement("div");k.className="dg-cell-item column-align-center";k.innerHTML=f.options.condition.start+1+a;d.appendChild(k);e.appendChild(d);var l=g.createElement("div");l.className="dg-right";l.style.left=h*f.options.numberIndexWidth+"px";l.style.width=h*(1-f.options.numberIndexWidth)+"px"}else l=e;var p=g.createElement("div");p.className="datafield";var q=0,n=0,r=1;b.each(f.options.field,function(b,a){var e=a.render&&"function"==typeof a.render?
a.render(c,c[a.name]):c[a.name];if(a.longText){var d=g.createElement("div");d.className="dg-long";1==r&&(d.className="dg-long dg-long-first",r++);var f=g.createElement("div");f.className="dg-long-cell";f.innerHTML="<b>"+a.fieldName+"</b>: &nbsp;<span>"+e+"</span>";d.appendChild(f);l.appendChild(d)}else d=g.createElement("div"),d.style.width=h*a.width+"px",d.style.left=h*a.width+"px",d.className="dg-cell",d.style.left=q+n++ +"px",q+=h*a.width,f=g.createElement("div"),f.className="dg-cell-item column-align-"+
a.itemAlign,f.innerHTML=e,d.appendChild(f),p.appendChild(d)});l.insertBefore(p,l.firstChild);e.appendChild(l);g.getElementById("dgbody").appendChild(e)});a=Math.ceil(Number(c/this.options.condition.length));for(var e=Math.ceil(Number(this.options.condition.start/this.options.condition.length))+1,d="",k=1;k<=a;k++)d+='<option value="'+k+'" '+(e==k?'selected="selected"':"")+">"+k+"</option>";b("#page").html(d);b("#page-size").val(this.options.condition.length);b("#page-total").html(c);b("#page-start").html(this.options.condition.start+
1);b("#page-end").html(this.options.condition.start+this.options.condition.length>c?c:this.options.condition.start+this.options.condition.length);1<e?(b(".page-first").removeClass("page-disable"),b(".page-pre").removeClass("page-disable")):(b(".page-first").addClass("page-disable"),b(".page-pre").addClass("page-disable"));e<a?(b(".page-last").removeClass("page-disable"),b(".page-next").removeClass("page-disable")):(b(".page-first").addClass("page-disable"),b(".page-pre").addClass("page-disable"))}else g.getElementById("dgbody").innerHTML=
'<div class="no-result">\u672a\u627e\u5230\u76f8\u5173\u6570\u636e</div>'};e.resize=function(){};b.fn.dataGrid=function(a){(new n(this,a)).init()}})(jQuery,window,document);